<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Genotype Score for Pairs of Individuals</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for snpgdsPairScore {SNPRelate}"><tr><td>snpgdsPairScore {SNPRelate}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Genotype Score for Pairs of Individuals
</h2>

<h3>Description</h3>

<p>Calculate the genotype score for pairs of individuals based on
identity-by-state (IBS) measure
</p>


<h3>Usage</h3>

<pre>
snpgdsPairScore(gdsobj, sample1.id, sample2.id, snp.id=NULL,
    method=c("IBS", "GVH", "HVG", "GVH.major", "GVH.minor", "GVH.major.only",
    "GVH.minor.only"), type=c("per.pair", "per.snp", "matrix", "gds.file"),
    dosage=TRUE, with.id=TRUE, output=NULL, verbose=TRUE)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>gdsobj</code></td>
<td>
<p>an object of class <code><a href="../../SNPRelate/help/SNPGDSFileClass.html">SNPGDSFileClass</a></code>,
a SNP GDS file</p>
</td></tr>
<tr valign="top"><td><code>sample1.id</code></td>
<td>
<p>a vector of sample id specifying selected samples;
if NULL, all samples are used</p>
</td></tr>
<tr valign="top"><td><code>sample2.id</code></td>
<td>
<p>a vector of sample id specifying selected samples;
if NULL, all samples are used</p>
</td></tr>
<tr valign="top"><td><code>snp.id</code></td>
<td>
<p>a vector of snp id specifying selected SNPs; if NULL,
all SNPs are used</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p><code>"IBS"</code> &ndash; identity-by-state score, <code>"GVH"</code>
or <code>"HVG"</code>, see Details</p>
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
<p><code>"per.pair"</code>, <code>"per.snp"</code> or <code>"matrix"</code>,
see Value</p>
</td></tr>
<tr valign="top"><td><code>dosage</code></td>
<td>
<p>TRUE, uses dosages 0, 1, 2; FALSE, uses 0, 1 (changing a
return value of 1 or 2 to be 1)</p>
</td></tr>
<tr valign="top"><td><code>with.id</code></td>
<td>
<p>if <code>TRUE</code>, returns &quot;sample.id&quot; and &quot;snp.id&quot;; see Value</p>
</td></tr>
<tr valign="top"><td><code>output</code></td>
<td>
<p>if <code>type="gds.file"</code>, the file name</p>
</td></tr>
<tr valign="top"><td><code>verbose</code></td>
<td>
<p>if TRUE, show information</p>
</td></tr>
</table>


<h3>Details</h3>


<table summary="Rd table">
<tr>
 <td style="text-align: center;">
        sample1.id </td><td style="text-align: center;"> sample2.id </td>
</tr>
<tr>
 <td style="text-align: center;">
        Patient </td><td style="text-align: center;"> Donor </td><td style="text-align: center;"> IBS </td><td style="text-align: center;"> GVH </td><td style="text-align: center;"> HVG </td><td style="text-align: center;"> GVH.major </td><td style="text-align: center;">
            GVH.minor </td><td style="text-align: center;"> GVH.major.only </td><td style="text-align: center;"> GVH.minor.only </td>
</tr>
<tr>
 <td style="text-align: center;">
        AA / 2 </td><td style="text-align: center;"> AA / 2 </td><td style="text-align: center;"> 2 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0  </td><td style="text-align: center;"> 0  </td>
</tr>
<tr>
 <td style="text-align: center;">
        AA / 2 </td><td style="text-align: center;"> AB / 1 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0  </td><td style="text-align: center;"> 0  </td>
</tr>
<tr>
 <td style="text-align: center;">
        AA / 2 </td><td style="text-align: center;"> BB / 0 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 2 </td><td style="text-align: center;"> 2 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 1  </td><td style="text-align: center;"> NA </td>
</tr>
<tr>
 <td style="text-align: center;">
        AB / 1 </td><td style="text-align: center;"> AA / 2 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> NA </td><td style="text-align: center;"> 1  </td>
</tr>
<tr>
 <td style="text-align: center;">
        AB / 1 </td><td style="text-align: center;"> AB / 1 </td><td style="text-align: center;"> 2 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0  </td><td style="text-align: center;"> 0  </td>
</tr>
<tr>
 <td style="text-align: center;">
        AB / 1 </td><td style="text-align: center;"> BB / 0 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 1  </td><td style="text-align: center;"> NA </td>
</tr>
<tr>
 <td style="text-align: center;">
        BB / 0 </td><td style="text-align: center;"> AA / 2 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 2 </td><td style="text-align: center;"> 2 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> NA </td><td style="text-align: center;"> 1  </td>
</tr>
<tr>
 <td style="text-align: center;">
        BB / 0 </td><td style="text-align: center;"> AB / 1 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 1 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0  </td><td style="text-align: center;"> 0  </td>
</tr>
<tr>
 <td style="text-align: center;">
        BB / 0 </td><td style="text-align: center;"> BB / 0 </td><td style="text-align: center;"> 2 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0 </td><td style="text-align: center;"> 0  </td><td style="text-align: center;"> 0  </td>
</tr>
<tr>
 <td style="text-align: center;">
    </td>
</tr>

</table>



<h3>Value</h3>

<p>Return a list:
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>sample.id</code></td>
<td>
<p>the sample ids used in the analysis,
if <code>with.id=TRUE</code></p>
</td></tr>
<tr valign="top"><td><code>snp.id</code></td>
<td>
<p>the SNP ids used in the analysis, if <code>with.id=TRUE</code></p>
</td></tr>
<tr valign="top"><td><code>score</code></td>
<td>
<p>a matrix of genotype score:
if <code>type="per.pair"</code>, a <code>data.frame</code> with the
first column for average scores, the second column for standard
deviation and the third column for the valid number of SNPs;
the additional columns for pairs of samples.
if <code>type="per.snp"</code>, a 3-by-<code># of SNPs</code> matrix with the first
row for average scores, the second row for standard deviation and
the third row for the valid number of individual pairs;
if <code>type="matrix"</code>, a <code># of pairs</code>-by-<code># of SNPs</code>
matrix with rows for pairs of individuals</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Xiuwen Zheng</p>


<h3>References</h3>

<p>Warren, E. H., Zhang, X. C., Li, S., Fan, W., Storer, B. E., Chien, J. W.,
Boeckh, M. J., et al. (2012). Effect of MHC and non-MHC donor/recipient
genetic disparity on the outcome of allogeneic HCT. Blood, 120(14), 2796-806.
doi:10.1182/blood-2012-04-347286
</p>


<h3>See Also</h3>

<p><code><a href="../../SNPRelate/help/snpgdsIBS.html">snpgdsIBS</a></code>
</p>


<h3>Examples</h3>

<pre>
# open an example dataset (HapMap)
genofile &lt;- snpgdsOpen(snpgdsExampleFileName())

# autosomal SNPs
selsnp &lt;- snpgdsSelectSNP(genofile, autosome.only=TRUE, remove.monosnp=FALSE)

# sample ID
sample.id &lt;- read.gdsn(index.gdsn(genofile, "sample.id"))
father.id &lt;- read.gdsn(index.gdsn(genofile, "sample.annot/father.id"))

offspring.id &lt;- sample.id[father.id != ""]
father.id &lt;- father.id[father.id != ""]


# calculate average genotype scores
z1 &lt;- snpgdsPairScore(genofile, offspring.id, father.id, snp.id=selsnp,
    method="IBS", type="per.pair")
str(z1)
head(z1$score)

# calculate average genotype scores
z1 &lt;- snpgdsPairScore(genofile, offspring.id, father.id, snp.id=selsnp,
    method="IBS", type="per.pair", dosage=FALSE)
str(z1)
head(z1$score)


# calculate average genotype scores
z2 &lt;- snpgdsPairScore(genofile, offspring.id, father.id, snp.id=selsnp,
    method="IBS", type="per.snp")
str(z2)
z2$score[, 1:4]
mean(z2$score["Avg",])
mean(z2$score["SD",])

plot(z2$score["Avg",], pch=20, cex=0.75, xlab="SNP Index", ylab="IBS score")


# calculate a matrix of genotype scores over samples and SNPs
z3 &lt;- snpgdsPairScore(genofile, offspring.id, father.id, snp.id=selsnp,
    method="IBS", type="matrix")
str(z3)


# output the score matrix to a GDS file
snpgdsPairScore(genofile, offspring.id, father.id, snp.id=selsnp,
    method="IBS", type="gds.file", output="tmp.gds")
(f &lt;- snpgdsOpen("tmp.gds"))
snpgdsClose(f)


# close the file
snpgdsClose(genofile)

unlink("tmp.gds", force=TRUE)
</pre>

<hr /><div style="text-align: center;">[Package <em>SNPRelate</em> version 1.28.0 <a href="00Index.html">Index</a>]</div>
</div></body></html>
