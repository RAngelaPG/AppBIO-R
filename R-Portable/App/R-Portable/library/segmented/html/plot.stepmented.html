<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Plot method for stepmented objects</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
<link rel="stylesheet" type="text/css" href="R.css" />
</head><body><div class="container">

<table width="100%" summary="page for plot.stepmented {segmented}"><tr><td>plot.stepmented {segmented}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>
Plot method for stepmented objects
</h2>

<h3>Description</h3>

<p>Takes a fitted <code>stepmented</code> object returned by <code>stepmented()</code> and plots (or adds)
the fitted piecewise constant lines for the selected stepmented term.
</p>


<h3>Usage</h3>

<pre>
## S3 method for class 'stepmented'
plot(x, term, add = FALSE, res = TRUE, conf.level=0, interc = TRUE, add.fx = FALSE, 
      psi.lines = TRUE, link=FALSE, const=NULL, res.col=grey(.15, alpha = .4), 
      surf=FALSE, zero.cor=TRUE, heurs=TRUE, shade=FALSE, se.type=c("cdf","abs","none"), 
      k=NULL, .vcov=NULL, leg="topleft", ...)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>

<p>a fitted <code>stepmented</code> object.
</p>
</td></tr>
<tr valign="top"><td><code>term</code></td>
<td>

<p>the stepmented variable having the piece-wise constant relationship to be plotted.
If there is a single stepmented variable in the fitted model <code>x</code>, 
<code>term</code> can be omitted.
</p>
</td></tr>
<tr valign="top"><td><code>add</code></td>
<td>

<p>when <code>TRUE</code> the fitted lines are added to the current device.
</p>
</td></tr>
<tr valign="top"><td><code>res</code></td>
<td>

<p>when <code>TRUE</code> the fitted lines are plotted along with corresponding partial residuals.
</p>
</td></tr>
<tr valign="top"><td><code>conf.level</code></td>
<td>

<p>the confidence level for the pointwise confidence intervals for the expected values.
</p>
</td></tr>
<tr valign="top"><td><code>interc</code></td>
<td>

<p>if <code>TRUE</code> the computed components include the model intercept (if it exists).
</p>
</td></tr>
<tr valign="top"><td><code>add.fx</code></td>
<td>

<p>logical. If TRUE and the object fit also includes an additional term for the same stepmented variable, the plot also portrays such &lsquo;additional&rsquo; term. 
</p>
</td></tr>
<tr valign="top"><td><code>psi.lines</code></td>
<td>

<p>if <code>TRUE</code> vertical lines corresponding to the estimated changepoints are also drawn
</p>
</td></tr>
<tr valign="top"><td><code>link</code></td>
<td>

<p>if <code>FALSE</code> the fitted lines (and possibily the residuals) are reported on the response scale. Ignored if the fit object <code>x</code> is not a glm-like fit.
</p>
</td></tr>
<tr valign="top"><td><code>const</code></td>
<td>
<p> constant to add to each fitted segmented relationship (on the scale of the linear predictor) before plotting.
If <code>const=NULL</code> and the fit includes a segmented interaction term (obtained via <code>seg(..,by)</code> in the formula), the group-specific intercept is included. 
</p>
</td></tr>
<tr valign="top"><td><code>res.col</code></td>
<td>
<p>when <code>res=TRUE</code> it means the color of the points representing the partial residuals.</p>
</td></tr>
<tr valign="top"><td><code>surf</code></td>
<td>

<p>if the object fit <code>x</code> includes 2 stepmented covariates (x1 and x2, say) with relevant estimated breakpoints, <code>surf=TRUE</code> will draw on the plane x1-x2 the areas splitted according to the estimated breakpoints with corresponding estimated means superimposed.
</p>
</td></tr>
<tr valign="top"><td><code>zero.cor</code></td>
<td>

<p>see <code>zero.cor</code> in <code><a href="../../segmented/help/vcov.stepmented.html">vcov.stepmented</a></code>; effective only if <code>conf.level&gt;0</code>.
</p>
</td></tr>
<tr valign="top"><td><code>heurs</code></td>
<td>

<p>logical; if <code>TRUE</code>, heuristic (usually somewhat conservative) confidence intervals are computed and plotted; effective only if <code>conf.level&gt;0</code>. 
</p>
</td></tr>
<tr valign="top"><td><code>shade</code></td>
<td>

<p>if <code>TRUE</code> the pointwise confidence intervals are portrayed via shaded area; effective only if <code>conf.level&gt;0</code>.
</p>
</td></tr>
<tr valign="top"><td><code>se.type</code></td>
<td>

<p>which standard errors should be computed? see <code>type</code> in <code><a href="../../segmented/help/vcov.stepmented.html">vcov.stepmented</a></code>; effective only if <code>conf.level&gt;0</code>.
</p>
</td></tr>
<tr valign="top"><td><code>k</code></td>
<td>

<p>The value to be passed to <code>vcov.stepmented</code> to computed the standard errors.
</p>
</td></tr>
<tr valign="top"><td><code>.vcov</code></td>
<td>

<p>The estimate var-covariance matrix; if <code>NULL</code>, it is computed internally by <code><a href="../../segmented/help/vcov.stepmented.html">vcov.stepmented</a></code>.
</p>
</td></tr>
<tr valign="top"><td><code>leg</code></td>
<td>

<p>If the plot refers to stepmented relationships in groups, i.e. <code>term</code> has been specified as a vector, a legend is placed at the specified <code>leg</code> position. Put <code>NA</code> not to draw the legend.
</p>
</td></tr>
<tr valign="top"><td><code>...</code></td>
<td>
<p> other graphics parameters to pass to plotting commands: &lsquo;col&rsquo;, &lsquo;lwd&rsquo; and &lsquo;lty&rsquo; (that
can be vectors and are recycled if necessary, see the example below) for the fitted piecewise constant lines; &lsquo;ylab&rsquo;, &lsquo;xlab&rsquo;, &lsquo;main&rsquo;, &lsquo;sub&rsquo;, &lsquo;cex.axis&rsquo;, &lsquo;cex.lab&rsquo;, &lsquo;xlim&rsquo; and &lsquo;ylim&rsquo; when a new plot is produced (i.e. when <code>add=FALSE</code>); &lsquo;pch&rsquo; and &lsquo;cex&rsquo; for the partial residuals (when <code>res=TRUE</code>, <code>res.col</code> is for the color).
</p>
</td></tr>
</table>


<h3>Details</h3>

<p>Produces (or adds to the current device) the fitted step-function like relationship between the
response and the selected <code>term</code>. If the fitted model includes just a single &lsquo;stepmented&rsquo; variable,
<code>term</code> may be omitted. If <code>surf=TRUE</code>, and <code>res=TRUE</code> the point widths are proportional to the partial residual values. 
</p>


<h3>Value</h3>

<p>None.
</p>


<h3>Note</h3>

<p>Implementation of confidence intervals for the conditional means in stepmented regression is under development; <code>conf.level&gt;0</code> should be used with care, especially with multiple jumpoints.
</p>


<h3>Author(s)</h3>

<p>Vito M. R. Muggeo
</p>


<h3>See Also</h3>

<p>See Also as <code><a href="../../segmented/help/stepmented.html">stepmented</a></code>
</p>


<h3>Examples</h3>

<pre>

#Following code in stepmented..
## Not run: 

par(mfrow=c(1,3))

plot(os,"x")
plot(os,"z")
plot(os,"z", add.fx=TRUE, psi.lines=FALSE ) 
lines(os, "z")

#display the 'surface'
par(mfrow=c(1,3))
plot(os, surf=TRUE, col=1, res.col=2)
plot(os, surf=TRUE, lty=2)
plot(x,z)
plot(os, surf=TRUE, add=TRUE, col=4, res=FALSE)


## End(Not run)

</pre>

<hr /><div style="text-align: center;">[Package <em>segmented</em> version 2.1-0 <a href="00Index.html">Index</a>]</div>
</div></body></html>
